CREATE OR REPLACE TABLE `ppdb-dev-438721.ppdb_lsstcam.DiaSource` (
	`diaSourceId` INT64 NOT NULL OPTIONS(description='Unique identifier of this DiaSource.'), 
	`visit` INT64 NOT NULL OPTIONS(description='Id of the visit where this diaSource was measured.'), 
	`detector` INT64 NOT NULL OPTIONS(description='Id of the detector where this diaSource was measured. Datatype short instead of byte because of DB concerns about unsigned bytes.'), 
	`diaObjectId` INT64 OPTIONS(description='Id of the diaObject this source was associated with, if any. If not, it is set to NULL (each diaSource will be associated with either a diaObject or ssObject).'), 
	`ssObjectId` INT64 OPTIONS(description='Id of the ssObject this source was associated with, if any. If not, it is set to NULL (each diaSource will be associated with either a diaObject or ssObject).'), 
	`parentDiaSourceId` INT64 OPTIONS(description='Id of the parent diaSource this diaSource has been deblended from, if any.'), 
	`ssObjectReassocTime` TIMESTAMP OPTIONS(description='Time when this diaSource was reassociated from diaObject to ssObject (if such reassociation happens, otherwise NULL).'), 
	`midpointMjdTai` FLOAT64 NOT NULL OPTIONS(description='Effective mid-visit time for this diaSource, expressed as Modified Julian Date, International Atomic Time.'), 
	`ra` FLOAT64 NOT NULL OPTIONS(description='Right ascension coordinate of the center of this diaSource.'), 
	`raErr` FLOAT64 OPTIONS(description='Uncertainty of ra.'), 
	`dec` FLOAT64 NOT NULL OPTIONS(description='Declination coordinate of the center of this diaSource.'), 
	`decErr` FLOAT64 OPTIONS(description='Uncertainty of dec.'), 
	`ra_dec_Cov` FLOAT64 OPTIONS(description='Covariance between ra and dec.'), 
	`x` FLOAT64 NOT NULL OPTIONS(description='x position computed by a centroiding algorithm.'), 
	`xErr` FLOAT64 OPTIONS(description='Uncertainty of x.'), 
	`y` FLOAT64 NOT NULL OPTIONS(description='y position computed by a centroiding algorithm.'), 
	`yErr` FLOAT64 OPTIONS(description='Uncertainty of y.'), 
	`x_y_Cov` FLOAT64 OPTIONS(description='Covariance between x and y.'), 
	`centroid_flag` BOOL OPTIONS(description='General centroid algorithm failure flag; set if anything went wrong when fitting the centroid. Another centroid flag field should also be set to provide more information.'), 
	`apFlux` FLOAT64 OPTIONS(description='Flux in a 12 pixel radius aperture on the difference image.'), 
	`apFluxErr` FLOAT64 OPTIONS(description='Estimated uncertainty of apFlux.'), 
	`apFlux_flag` BOOL OPTIONS(description='General aperture flux algorithm failure flag; set if anything went wrong when measuring aperture fluxes. Another apFlux flag field should also be set to provide more information.'), 
	`apFlux_flag_apertureTruncated` BOOL OPTIONS(description='Aperture did not fit within measurement image.'), 
	`is_negative` BOOL OPTIONS(description='Source was detected as significantly negative.'), 
	`snr` FLOAT64 OPTIONS(description='The signal-to-noise ratio at which this source was detected in the difference image.'), 
	`psfFlux` FLOAT64 OPTIONS(description='Flux for Point Source model. Note this actually measures the flux difference between the template and the visit image.'), 
	`psfFluxErr` FLOAT64 OPTIONS(description='Uncertainty of psfFlux.'), 
	`psfRa` FLOAT64 OPTIONS(description='Right ascension coordinate of centroid for point source model.'), 
	`psfRaErr` FLOAT64 OPTIONS(description='Uncertainty of psfRa.'), 
	`psfDec` FLOAT64 OPTIONS(description='Declination coordinate of centroid for point source model.'), 
	`psfDecErr` FLOAT64 OPTIONS(description='Uncertainty of psfDec.'), 
	`psfFlux_psfRa_Cov` FLOAT64 OPTIONS(description='Covariance between psfFlux and psfRa.'), 
	`psfFlux_psfDec_Cov` FLOAT64 OPTIONS(description='Covariance between psfFlux and psfDec.'), 
	`psfRa_psfDec_Cov` FLOAT64 OPTIONS(description='Covariance between psfRa and psfDec.'), 
	`psfLnL` FLOAT64 OPTIONS(description='Natural log likelihood of the observed data given the point source model.'), 
	`psfChi2` FLOAT64 OPTIONS(description='Chi^2 statistic of the point source model fit.'), 
	`psfNdata` INT64 OPTIONS(description='The number of data points (pixels) used to fit the point source model.'), 
	`psfFlux_flag` BOOL OPTIONS(description='Failure to derive linear least-squares fit of psf model. Another psfFlux flag field should also be set to provide more information.'), 
	`psfFlux_flag_edge` BOOL OPTIONS(description='Object was too close to the edge of the image to use the full PSF model.'), 
	`psfFlux_flag_noGoodPixels` BOOL OPTIONS(description='Not enough non-rejected pixels in data to attempt the fit.'), 
	`trailFlux` FLOAT64 OPTIONS(description='Flux for a trailed source model. Note this actually measures the flux difference between the template and the visit image.'), 
	`trailFluxErr` FLOAT64 OPTIONS(description='Uncertainty of trailFlux.'), 
	`trailRa` FLOAT64 OPTIONS(description='Right ascension coordinate of centroid for trailed source model.'), 
	`trailRaErr` FLOAT64 OPTIONS(description='Uncertainty of trailRa.'), 
	`trailDec` FLOAT64 OPTIONS(description='Declination coordinate of centroid for trailed source model.'), 
	`trailDecErr` FLOAT64 OPTIONS(description='Uncertainty of trailDec.'), 
	`trailLength` FLOAT64 OPTIONS(description='Maximum likelihood fit of trail length.'), 
	`trailLengthErr` FLOAT64 OPTIONS(description='Uncertainty of trailLength.'), 
	`trailAngle` FLOAT64 OPTIONS(description='Maximum likelihood fit of the angle between the meridian through the centroid and the trail direction (bearing).'), 
	`trailAngleErr` FLOAT64 OPTIONS(description='Uncertainty of trailAngle.'), 
	`trailFlux_trailRa_Cov` FLOAT64 OPTIONS(description='Covariance of trailFlux and trailRa.'), 
	`trailFlux_trailDec_Cov` FLOAT64 OPTIONS(description='Covariance of trailFlux and trailDec.'), 
	`trailFlux_trailLength_Cov` FLOAT64 OPTIONS(description='Covariance of trailFlux and trailLength'), 
	`trailFlux_trailAngle_Cov` FLOAT64 OPTIONS(description='Covariance of trailFlux and trailAngle'), 
	`trailRa_trailDec_Cov` FLOAT64 OPTIONS(description='Covariance of trailRa and trailDec.'), 
	`trailRa_trailLength_Cov` FLOAT64 OPTIONS(description='Covariance of trailRa and trailLength.'), 
	`trailRa_trailAngle_Cov` FLOAT64 OPTIONS(description='Covariance of trailRa and trailAngle.'), 
	`trailDec_trailLength_Cov` FLOAT64 OPTIONS(description='Covariance of trailDec and trailLength.'), 
	`trailDec_trailAngle_Cov` FLOAT64 OPTIONS(description='Covariance of trailDec and trailAngle.'), 
	`trailLength_trailAngle_Cov` FLOAT64 OPTIONS(description='Covariance of trailLength and trailAngle'), 
	`trailLnL` FLOAT64 OPTIONS(description='Natural log likelihood of the observed data given the trailed source model.'), 
	`trailChi2` FLOAT64 OPTIONS(description='Chi^2 statistic of the trailed source model fit.'), 
	`trailNdata` INT64 DEFAULT 0 OPTIONS(description='The number of data points (pixels) used to fit the trailed source model.'), 
	`trail_flag_edge` BOOL OPTIONS(description='This flag is set if a trailed source extends onto or past edge pixels.'), 
	`dipoleMeanFlux` FLOAT64 OPTIONS(description='Maximum likelihood value for the mean absolute flux of the two lobes for a dipole model.'), 
	`dipoleMeanFluxErr` FLOAT64 OPTIONS(description='Uncertainty of dipoleMeanFlux.'), 
	`dipoleFluxDiff` FLOAT64 OPTIONS(description='Maximum likelihood value for the difference of absolute fluxes of the two lobes for a dipole model.'), 
	`dipoleFluxDiffErr` FLOAT64 OPTIONS(description='Uncertainty of dipoleFluxDiff.'), 
	`dipoleRa` FLOAT64 OPTIONS(description='Right ascension coordinate of centroid for dipole model.'), 
	`dipoleRaErr` FLOAT64 OPTIONS(description='Uncertainty of dipoleRa.'), 
	`dipoleDec` FLOAT64 OPTIONS(description='Declination coordinate of centroid for dipole model.'), 
	`dipoleDecErr` FLOAT64 OPTIONS(description='Uncertainty of dipoleDec.'), 
	`dipoleLength` FLOAT64 OPTIONS(description='Maximum likelihood value for the lobe separation in dipole model.'), 
	`dipoleLengthErr` FLOAT64 OPTIONS(description='Uncertainty of dipoleLength.'), 
	`dipoleAngle` FLOAT64 OPTIONS(description='Maximum likelihood fit of the angle between the meridian through the centroid and the dipole direction (bearing, from negative to positive lobe).'), 
	`dipoleAngleErr` FLOAT64 OPTIONS(description='Uncertainty of dipoleAngle.'), 
	`dipoleMeanFlux_dipoleFluxDiff_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleMeanFlux and dipoleFluxDiff.'), 
	`dipoleMeanFlux_dipoleRa_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleMeanFlux and dipoleRa.'), 
	`dipoleMeanFlux_dipoleDec_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleMeanFlux and dipoleDec.'), 
	`dipoleMeanFlux_dipoleLength_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleMeanFlux and dipoleLength.'), 
	`dipoleMeanFlux_dipoleAngle_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleMeanFlux and dipoleAngle.'), 
	`dipoleFluxDiff_dipoleRa_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleFluxDiff and dipoleRa.'), 
	`dipoleFluxDiff_dipoleDec_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleFluxDiff and dipoleDec.'), 
	`dipoleFluxDiff_dipoleLength_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleFluxDiff and dipoleLength.'), 
	`dipoleFluxDiff_dipoleAngle_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleFluxDiff and dipoleAngle.'), 
	`dipoleRa_dipoleDec_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleRa and dipoleDec.'), 
	`dipoleRa_dipoleLength_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleRa and dipoleLength.'), 
	`dipoleRa_dipoleAngle_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleRa and dipoleAngle.'), 
	`dipoleDec_dipoleLength_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleDec and dipoleLength.'), 
	`dipoleDec_dipoleAngle_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleDec and dipoleAngle.'), 
	`dipoleLength_dipoleAngle_Cov` FLOAT64 OPTIONS(description='Covariance of dipoleLength and dipoleAngle.'), 
	`dipoleLnL` FLOAT64 OPTIONS(description='Natural log likelihood of the observed data given the dipole source model.'), 
	`dipoleChi2` FLOAT64 OPTIONS(description='Chi^2 statistic of the model fit.'), 
	`dipoleNdata` INT64 OPTIONS(description='The number of data points (pixels) used to fit the model.'), 
	`scienceFlux` FLOAT64 OPTIONS(description='Forced photometry flux for a point source model measured on the visit image centered at DiaSource position.'), 
	`scienceFluxErr` FLOAT64 OPTIONS(description='Estimated uncertainty of scienceFlux.'), 
	`forced_PsfFlux_flag` BOOL OPTIONS(description='Forced PSF photometry on science image failed. Another forced_PsfFlux flag field should also be set to provide more information.'), 
	`forced_PsfFlux_flag_edge` BOOL OPTIONS(description='Forced PSF flux on science image was too close to the edge of the image to use the full PSF model.'), 
	`forced_PsfFlux_flag_noGoodPixels` BOOL OPTIONS(description='Forced PSF flux not enough non-rejected pixels in data to attempt the fit.'), 
	`snapDiffFlux` FLOAT64 OPTIONS(description='Calibrated flux for Point Source model centered on radec but measured on the difference of snaps comprising this visit.'), 
	`snapDiffFluxErr` FLOAT64 OPTIONS(description='Estimated uncertainty of snapDiffFlux.'), 
	`fpBkgd` FLOAT64 OPTIONS(description='Estimated sky background at the position (centroid) of the object.'), 
	`fpBkgdErr` FLOAT64 OPTIONS(description='Estimated uncertainty of fpBkgd.'), 
	`ixx` FLOAT64 OPTIONS(description='Adaptive second moment of the source intensity.'), 
	`ixxErr` FLOAT64 OPTIONS(description='Uncertainty of ixx.'), 
	`iyy` FLOAT64 OPTIONS(description='Adaptive second moment of the source intensity.'), 
	`iyyErr` FLOAT64 OPTIONS(description='Uncertainty of iyy.'), 
	`ixy` FLOAT64 OPTIONS(description='Adaptive second moment of the source intensity.'), 
	`ixyErr` FLOAT64 OPTIONS(description='Uncertainty of ixy.'), 
	`ixx_iyy_Cov` FLOAT64 OPTIONS(description='Covariance of ixx and iyy.'), 
	`ixx_ixy_Cov` FLOAT64 OPTIONS(description='Covariance of ixx and ixy.'), 
	`iyy_ixy_Cov` FLOAT64 OPTIONS(description='Covariance of iyy and ixy.'), 
	`ixxPSF` FLOAT64 OPTIONS(description='Adaptive second moment for the PSF.'), 
	`iyyPSF` FLOAT64 OPTIONS(description='Adaptive second moment for the PSF.'), 
	`ixyPSF` FLOAT64 OPTIONS(description='Adaptive second moment for the PSF.'), 
	`shape_flag` BOOL OPTIONS(description='General source shape algorithm failure flag; set if anything went wrong when measuring the shape. Another shape flag field should also be set to provide more information.'), 
	`shape_flag_no_pixels` BOOL OPTIONS(description='No pixels to measure shape.'), 
	`shape_flag_not_contained` BOOL OPTIONS(description='Center not contained in footprint bounding box.'), 
	`shape_flag_parent_source` BOOL OPTIONS(description='This source is a parent source; we should only be measuring on deblended children in difference imaging.'), 
	`extendedness` FLOAT64 OPTIONS(description="A measure of extendedness, computed by comparing an object's moment-based traced radius to the PSF moments. extendedness = 1 implies a high degree of confidence that the source is extended. extendedness = 0 implies a high degree of confidence that the source is point-like."), 
	`reliability` FLOAT64 OPTIONS(description='A measure of reliability, computed using information from the source and image characterization, as well as the information on the Telescope and Camera system (e.g., ghost maps, defect maps, etc.).'), 
	`band` STRING(1) OPTIONS(description='Filter band this source was observed with.'), 
	`isDipole` BOOL OPTIONS(description='Source well fit by a dipole.'), 
	`dipoleFitAttempted` BOOL OPTIONS(description='Attempted to fit a dipole model to this source.'), 
	`time_processed` TIMESTAMP NOT NULL OPTIONS(description='Time when the image was processed and this DiaSource record was generated.'), 
	`time_withdrawn` TIMESTAMP OPTIONS(description='Time when this record was marked invalid.'), 
	`bboxSize` INT64, 
	`pixelFlags` BOOL OPTIONS(description="General pixel flags failure; set if anything went wrong when setting pixels flags from this footprint's mask. This implies that some pixelFlags for this source may be incorrectly set to False."), 
	`pixelFlags_bad` BOOL OPTIONS(description='Bad pixel in the DiaSource footprint.'), 
	`pixelFlags_cr` BOOL OPTIONS(description='Cosmic ray in the DiaSource footprint.'), 
	`pixelFlags_crCenter` BOOL OPTIONS(description='Cosmic ray in the 3x3 region around the centroid.'), 
	`pixelFlags_edge` BOOL OPTIONS(description='Some of the source footprint is outside usable exposure region (masked EDGE or centroid off image).'), 
	`pixelFlags_nodata` BOOL OPTIONS(description='NO_DATA pixel in the source footprint.'), 
	`pixelFlags_nodataCenter` BOOL OPTIONS(description='NO_DATA pixel in the 3x3 region around the centroid.'), 
	`pixelFlags_interpolated` BOOL OPTIONS(description='Interpolated pixel in the DiaSource footprint.'), 
	`pixelFlags_interpolatedCenter` BOOL OPTIONS(description='Interpolated pixel in the 3x3 region around the centroid.'), 
	`pixelFlags_offimage` BOOL OPTIONS(description='DiaSource center is off image.'), 
	`pixelFlags_saturated` BOOL OPTIONS(description='Saturated pixel in the DiaSource footprint.'), 
	`pixelFlags_saturatedCenter` BOOL OPTIONS(description='Saturated pixel in the 3x3 region around the centroid.'), 
	`pixelFlags_suspect` BOOL OPTIONS(description="DiaSource's footprint includes suspect pixels."), 
	`pixelFlags_suspectCenter` BOOL OPTIONS(description='Suspect pixel in the 3x3 region around the centroid.'), 
	`pixelFlags_streak` BOOL OPTIONS(description='Streak in the DiaSource footprint.'), 
	`pixelFlags_streakCenter` BOOL OPTIONS(description='Streak in the 3x3 region around the centroid.'), 
	`pixelFlags_injected` BOOL OPTIONS(description='Injection in the DiaSource footprint.'), 
	`pixelFlags_injectedCenter` BOOL OPTIONS(description='Injection in the 3x3 region around the centroid.'), 
	`pixelFlags_injected_template` BOOL OPTIONS(description='Template injection in the DiaSource footprint.'), 
	`pixelFlags_injected_templateCenter` BOOL OPTIONS(description='Template injection in the 3x3 region around the centroid.'), 
	`glint_trail` BOOL OPTIONS(description='This flag is set if the source is part of a glint trail.')
)
CLUSTER BY diaObjectId
OPTIONS(description='Table to store difference image sources; - sources detected at SNR >=5 on difference images.')